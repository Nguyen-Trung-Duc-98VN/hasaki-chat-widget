(this["webpackJsonphasaki-chat-client"]=this["webpackJsonphasaki-chat-client"]||[]).push([[0],{102:function(e,n,t){},103:function(e,n,t){"use strict";t.r(n);var r=t(1),o=t.n(r),a=t(19),i=t.n(a),s=t(10),c=t(13),l=t(38),d=t(5),u=t(14),f=t.n(u),v=t(21),g="REQUIRE_ROOM_REQUEST",p="REQUIRE_ROOM_SUCCESS",m="REQUIRE_ROOM_ERROR",b="CHAT_NEW_MESSAGE_REQUEST",h="CHAT_NEW_MESSAGE_SUCCESS",y="CHAT_NEW_MESSAGE_ERROR",w="CHAT_SCROLLLOAD_REQUEST",j="CHAT_SCROLLLOAD_SUCCESS",S="CHAT_SCROLLLOAD_ERROR",O=t(3),_=t(39),x=t.n(_),C=t(40),k=t.n(C),R=200,T="Nguy\u1ec5n Trung \u0110\u1ee9c",N="1-4652-Nguy\u1ec5n \u0110\u1eafc Ch\xed",D=x.a.create({baseURL:"https://chat.hasaki.vn",timeout:5e4,headers:{"content-type":"application/json","x-hskchat-app-id":"8220ce43-fb61-42c2-9308-7adc70203e88","x-hskchat-app-token":"wYBPg75D2pI9p4K7NzKKvV8TtNVjcMz9"},paramsSerializer:function(e){return k.a.stringify(e)}}),I="/api/v1/chat",A=function(e){return D({method:"POST",url:"".concat(I,"/new"),data:e})},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D({method:"GET",url:"".concat(I,"/scrollLoad"),params:Object(O.a)({},e)})},M=t(11),L=t.n(M),P="JANUS_CONNECT_REQUEST_ACTION",J="JANUS_CONNECT_SUCCESS_ACTION",U="JANUS_CONNECT_ERROR_ACTION",B=t(4);function V(e){if(void 0===V.initDone)return e.error("Library not initialized"),{};if(!V.isWebrtcSupported())return e.error("WebRTC not supported by this browser"),{};if(V.log("Library initialized: "+V.initDone),(e=e||{}).success="function"==typeof e.success?e.success:V.noop,e.error="function"==typeof e.error?e.error:V.noop,e.destroyed="function"==typeof e.destroyed?e.destroyed:V.noop,null===e.server||void 0===e.server)return e.error("Invalid gateway url"),{};var n=!1,t=null,r={},o=null,a=null,i=0,s=e.server;Array.isArray(s)?(V.log("Multiple servers provided ("+s.length+"), will use the first that works"),s=null,a=e.server,V.debug(a)):0===s.indexOf("ws")?(n=!0,V.log("Using WebSockets to contact Janus: "+s)):(n=!1,V.log("Using REST API to contact Janus: "+s));var c=e.iceServers;void 0!==c&&null!==c||(c=[{urls:"stun:stun.l.google.com:19302"}]);var l=e.iceTransportPolicy,d=e.ipv6;void 0!==d&&null!==d||(d=!1);var u=!1;void 0!==e.withCredentials&&null!==e.withCredentials&&(u=!0===e.withCredentials);var f=null;void 0!==e.max_poll_events&&null!==e.max_poll_events&&(f=e.max_poll_events),f<1&&(f=1);var v=null;void 0!==e.token&&null!==e.token&&(v=e.token);var g=null;void 0!==e.apisecret&&null!==e.apisecret&&(g=e.apisecret),this.destroyOnUnload=!0,void 0!==e.destroyOnUnload&&null!==e.destroyOnUnload&&(this.destroyOnUnload=!0===e.destroyOnUnload);var p=!1,m=null,b={},h=this,y=0,w={};function j(){if(null!=m)if(V.debug("Long poll..."),p){var n=s+"/"+m+"?rid="+(new Date).getTime();void 0!==f&&null!==f&&(n=n+"&maxev="+f),null!==v&&void 0!==v&&(n=n+"&token="+v),null!==g&&void 0!==g&&(n=n+"&apisecret="+g),V.ajax({type:"GET",url:n,withCredentials:u,cache:!1,timeout:6e4,success:S,error:function(n,t,r){if(V.error(t+": "+r),++y>3)return p=!1,void e.error("Lost connection to the gateway (is it down?)");j()},dataType:"json"})}else V.warn("Is the gateway down? (connected=false)")}function S(e,t){if(y=0,n||void 0===m||null===m||!0===t||setTimeout(j,200),n||!Array.isArray(e))if("keepalive"!==e.janus)if("ack"!==e.janus)if("success"!==e.janus){if("webrtcup"===e.janus)return V.debug("Got a webrtcup event on session "+m),V.debug(e),void 0===(r=e.sender)||null===r?void V.warn("Missing sender..."):void 0===(a=b[r])||null===a?void V.debug("This handle is not attached to this session"):void a.webrtcState(!0);if("hangup"===e.janus){if(V.debug("Got a hangup event on session "+m),V.debug(e),void 0===(r=e.sender)||null===r)return void V.warn("Missing sender...");if(void 0===(a=b[r])||null===a)return void V.debug("This handle is not attached to this session");a.webrtcState(!1,e.reason),a.hangup()}else if("detached"===e.janus){if(V.debug("Got a detached event on session "+m),V.debug(e),void 0===(r=e.sender)||null===r)return void V.warn("Missing sender...");if(void 0===(a=b[r])||null===a)return;a.detached=!0,a.ondetached(),a.detach()}else if("media"===e.janus){if(V.debug("Got a media event on session "+m),V.debug(e),void 0===(r=e.sender)||null===r)return void V.warn("Missing sender...");if(void 0===(a=b[r])||null===a)return void V.debug("This handle is not attached to this session");a.mediaState(e.type,e.receiving)}else if("slowlink"===e.janus){if(V.debug("Got a slowlink event on session "+m),V.debug(e),void 0===(r=e.sender)||null===r)return void V.warn("Missing sender...");if(void 0===(a=b[r])||null===a)return void V.debug("This handle is not attached to this session");a.slowLink(e.uplink,e.nacks)}else{if("error"===e.janus){if(V.error("Ooops: "+e.error.code+" "+e.error.reason),V.debug(e),null!==(l=e.transaction)&&void 0!==l)null!==(d=w[l])&&void 0!==d&&d(e),delete w[l];return}if("event"===e.janus){var r;if(V.debug("Got a plugin event on session "+m),V.debug(e),void 0===(r=e.sender)||null===r)return void V.warn("Missing sender...");var o=e.plugindata;if(void 0===o||null===o)return void V.warn("Missing plugindata...");V.debug("  -- Event is coming from "+r+" ("+o.plugin+")");var a,i=o.data;if(V.debug(i),void 0===(a=b[r])||null===a)return void V.warn("This handle is not attached to this session");var s=e.jsep;void 0!==s&&null!==s&&(V.debug("Handling SDP as well..."),V.debug(s));var c=a.onmessage;null!==c&&void 0!==c?(V.debug("Notifying application..."),c(i,s)):V.debug("No provided notification callback")}else V.warn("Unkown message/event  '"+e.janus+"' on session "+m),V.debug(e)}}else{var l,d;V.debug("Got a success on session "+m),V.debug(e),null!==(l=e.transaction)&&void 0!==l&&(null!==(d=w[l])&&void 0!==d&&d(e),delete w[l])}else V.debug("Got an ack on session "+m),V.debug(e),null!==(l=e.transaction)&&void 0!==l&&(null!==(d=w[l])&&void 0!==d&&d(e),delete w[l]);else V.vdebug("Got a keepalive on session "+m);else for(var u=0;u<e.length;u++)S(e[u],!0)}function O(){if(null!==s&&n&&p){o=setTimeout(O,3e4);var e={janus:"keepalive",session_id:m,transaction:V.randomString(12)};null!==v&&void 0!==v&&(e.token=v),null!==g&&void 0!==g&&(e.apisecret=g),t.send(JSON.stringify(e))}}function _(e,r){if((r=r||{}).success="function"==typeof r.success?r.success:V.noop,r.error="function"==typeof r.error?r.error:V.noop,!p)return V.warn("Is the gateway down? (connected=false)"),void r.error("Is the gateway down? (connected=false)");var o=r.message,a=r.jsep,i=V.randomString(12),c={janus:"message",body:o,transaction:i};if(null!==v&&void 0!==v&&(c.token=v),null!==g&&void 0!==g&&(c.apisecret=g),null!==a&&void 0!==a&&(c.jsep=a),V.debug("Sending message to plugin (handle="+e+"):"),V.debug(c),n)return c.session_id=m,c.handle_id=e,w[i]=function(e){if(V.debug("Message sent!"),V.debug(e),"success"===e.janus){var n=e.plugindata;if(void 0===n||null===n)return V.warn("Request succeeded, but missing plugindata..."),void r.success();V.log("Synchronous transaction successful ("+n.plugin+")");var t=n.data;return V.debug(t),void r.success(t)}"ack"===e.janus?r.success():void 0!==e.error&&null!==e.error?(V.error("Ooops: "+e.error.code+" "+e.error.reason),r.error(e.error.code+" "+e.error.reason)):(V.error("Unknown error"),r.error("Unknown error"))},console.log("~~~~~~",c),void t.send(JSON.stringify(c));V.ajax({type:"POST",url:s+"/"+m+"/"+e,withCredentials:u,cache:!1,contentType:"application/json",data:JSON.stringify(c),success:function(e){if(V.debug("Message sent!"),V.debug(e),"success"===e.janus){var n=e.plugindata;if(void 0===n||null===n)return V.warn("Request succeeded, but missing plugindata..."),void r.success();V.log("Synchronous transaction successful ("+n.plugin+")");var t=n.data;return V.debug(t),void r.success(t)}"ack"===e.janus?r.success():void 0!==e.error&&null!==e.error?(V.error("Ooops: "+e.error.code+" "+e.error.reason),r.error(e.error.code+" "+e.error.reason)):(V.error("Unknown error"),r.error("Unknown error"))},error:function(e,n,t){V.error(n+": "+t),r.error(n+": "+t)},dataType:"json"})}function x(e,r){if(p){var o={janus:"trickle",candidate:r,transaction:V.randomString(12)};if(null!==v&&void 0!==v&&(o.token=v),null!==g&&void 0!==g&&(o.apisecret=g),V.vdebug("Sending trickle candidate (handle="+e+"):"),V.vdebug(o),n)return o.session_id=m,o.handle_id=e,void t.send(JSON.stringify(o));V.ajax({type:"POST",url:s+"/"+m+"/"+e,withCredentials:u,cache:!1,contentType:"application/json",data:JSON.stringify(o),success:function(e){V.vdebug("Candidate sent!"),V.vdebug(e),"ack"===e.janus||V.error("Ooops: "+e.error.code+" "+e.error.reason)},error:function(e,n,t){V.error(n+": "+t)},dataType:"json"})}else V.warn("Is the gateway down? (connected=false)")}function C(e,n){(n=n||{}).success="function"==typeof n.success?n.success:V.noop,n.error="function"==typeof n.error?n.error:V.noop;var t=b[e];if(null===t||void 0===t||null===t.webrtcStuff||void 0===t.webrtcStuff)return V.warn("Invalid handle"),void n.error("Invalid handle");var r=t.webrtcStuff,o=n.text;if(null===o||void 0===o)return V.warn("Invalid text"),void n.error("Invalid text");V.log("Sending string on data channel: "+o),r.dataChannel.send(o),n.success()}function k(e,n){(n=n||{}).success="function"==typeof n.success?n.success:V.noop,n.error="function"==typeof n.error?n.error:V.noop;var t=b[e];if(null===t||void 0===t||null===t.webrtcStuff||void 0===t.webrtcStuff)return V.warn("Invalid handle"),void n.error("Invalid handle");var r=t.webrtcStuff;if(null===r.dtmfSender||void 0===r.dtmfSender){if(void 0!==r.myStream&&null!==r.myStream){var o=r.myStream.getAudioTracks();if(null!==o&&void 0!==o&&o.length>0){var a=o[0];r.dtmfSender=r.pc.createDTMFSender(a),V.log("Created DTMF Sender"),r.dtmfSender.ontonechange=function(e){V.debug("Sent DTMF tone: "+e.tone)}}}if(null===r.dtmfSender||void 0===r.dtmfSender)return V.warn("Invalid DTMF configuration"),void n.error("Invalid DTMF configuration")}var i=n.dtmf;if(null===i||void 0===i)return V.warn("Invalid DTMF parameters"),void n.error("Invalid DTMF parameters");var s=i.tones;if(null===s||void 0===s)return V.warn("Invalid DTMF string"),void n.error("Invalid DTMF string");var c=i.duration;null!==c&&void 0!==c||(c=500);var l=i.gap;null!==l&&void 0!==l||(l=50),V.debug("Sending DTMF string "+s+" (duration "+c+"ms, gap "+l+"ms)"),r.dtmfSender.insertDTMF(s,c,l)}function R(e,r){(r=r||{}).success="function"==typeof r.success?r.success:V.noop,r.error="function"==typeof r.error?r.error:V.noop;var o=!0;if(void 0!==r.asyncRequest&&null!==r.asyncRequest&&(o=!0===r.asyncRequest),V.log("Destroying handle "+e+" (sync="+o+")"),U(e),b[e].detached)return delete b[e],void r.success();if(!p)return V.warn("Is the gateway down? (connected=false)"),void r.error("Is the gateway down? (connected=false)");var a={janus:"detach",transaction:V.randomString(12)};if(null!==v&&void 0!==v&&(a.token=v),null!==g&&void 0!==g&&(a.apisecret=g),n)return a.session_id=m,a.handle_id=e,t.send(JSON.stringify(a)),delete b[e],void r.success();V.ajax({type:"POST",url:s+"/"+m+"/"+e,async:o,withCredentials:u,cache:!1,contentType:"application/json",data:JSON.stringify(a),success:function(n){V.log("Destroyed handle:"),V.debug(n),"success"!==n.janus&&V.error("Ooops: "+n.error.code+" "+n.error.reason),delete b[e],r.success()},error:function(n,t,o){V.error(t+": "+o),delete b[e],r.success()},dataType:"json"})}function T(e,n,t,r,o){var a=b[e];if(null===a||void 0===a||null===a.webrtcStuff||void 0===a.webrtcStuff)return V.warn("Invalid handle"),void r.error("Invalid handle");var i=a.webrtcStuff;V.debug("streamsDone:",o),i.myStream=o;var s={iceServers:c,iceTransportPolicy:l},u={optional:[{DtlsSrtpKeyAgreement:!0}]};if(!0===d&&u.optional.push({googIPv6:!0}),"edge"===B.a.browserDetails.browser&&(s.bundlePolicy="max-bundle"),V.log("Creating PeerConnection"),V.debug(u),i.pc=new RTCPeerConnection(s,u),V.debug(i.pc),i.pc.getStats&&(i.volume.value=0,i.bitrate.value="0 kbits/sec"),V.log("Preparing local SDP and gathering candidates (trickle="+i.trickle+")"),i.pc.oniceconnectionstatechange=function(e){i.pc&&a.iceState(i.pc.iceConnectionState)},i.pc.onicecandidate=function(n){if(null==n.candidate||"edge"===B.a.browserDetails.browser&&n.candidate.candidate.indexOf("endOfCandidates")>0)V.log("End of candidates."),i.iceDone=!0,!0===i.trickle?x(e,{completed:!0}):function(e,n){(n=n||{}).success="function"==typeof n.success?n.success:V.noop,n.error="function"==typeof n.error?n.error:V.noop;var t=b[e];if(null===t||void 0===t||null===t.webrtcStuff||void 0===t.webrtcStuff)return void V.warn("Invalid handle, not sending anything");var r=t.webrtcStuff;if(V.log("Sending offer/answer SDP..."),null===r.mySdp||void 0===r.mySdp)return void V.warn("Local SDP instance is invalid, not sending anything...");if(r.mySdp={type:r.pc.localDescription.type,sdp:r.pc.localDescription.sdp},r.sdpSent)return void V.log("Offer/Answer SDP already sent, not sending it again");!1===r.trickle&&(r.mySdp.trickle=!1);V.debug(n),r.sdpSent=!0,n.success(r.mySdp)}(e,r);else{var t={candidate:n.candidate.candidate,sdpMid:n.candidate.sdpMid,sdpMLineIndex:n.candidate.sdpMLineIndex};!0===i.trickle&&x(e,t)}},null!==o&&void 0!==o&&(V.log("Adding local stream"),i.pc.addStream(o),a.onlocalstream(o)),i.pc.onaddstream=function(e){V.log("Handling Remote Stream"),V.debug(e),i.remoteStream=e,a.onremotestream(e.stream)},function(e){if(V.debug("isDataEnabled:",e),"edge"==B.a.browserDetails.browser)return V.warn("Edge doesn't support data channels yet"),!1;return void 0!==e&&null!==e&&!0===e.data}(t)){V.log("Creating data channel");var f=function(){var e=null!==i.dataChannel?i.dataChannel.readyState:"null";V.log("State change on data channel: "+e),"open"===e&&a.ondataopen()};i.dataChannel=i.pc.createDataChannel("JanusDataChannel",{ordered:!1}),i.dataChannel.onmessage=function(e){V.log("Received message on data channel: "+e.data),a.ondata(e.data)},i.dataChannel.onopen=f,i.dataChannel.onclose=f,i.dataChannel.onerror=function(e){V.error("Got error on data channel:",e)}}null===n||void 0===n?I(e,t,r):("edge"===B.a.browserDetails.browser&&(n.sdp+="a=end-of-candidates\r\n"),i.pc.setRemoteDescription(new RTCSessionDescription(n),(function(){V.log("Remote description accepted!"),A(e,t,r)}),r.error))}function N(e,n){(n=n||{}).success="function"==typeof n.success?n.success:V.noop,n.error="function"==typeof n.error?n.error:J;var t=n.jsep,r=n.media,o=b[e];if(null===o||void 0===o||null===o.webrtcStuff||void 0===o.webrtcStuff)return V.warn("Invalid handle"),void n.error("Invalid handle");var a,i=o.webrtcStuff;if(void 0!==i.pc&&null!==i.pc)return V.log("Updating existing media session"),void(null===t||void 0===t?I(e,r,n):("edge"===B.a.browserDetails.browser&&(t.sdp+="a=end-of-candidates\r\n"),i.pc.setRemoteDescription(new RTCSessionDescription(t),(function(){V.log("Remote description accepted!"),A(e,r,n)}),n.error)));if(null!==n.stream&&void 0!==n.stream){var s=n.stream;return V.log("MediaStream provided by the application"),V.debug(s),i.streamExternal=!0,void T(e,t,r,n,s)}if(i.trickle=(a=n.trickle,V.debug("isTrickleEnabled:",a),void 0===a||null===a||!0===a),q(r)||W(r)){var c={mandatory:{},optional:[]};o.consentDialog(!0);var l=q(r);!0===l&&void 0!=r&&null!=r&&"object"===typeof r.audio&&(l=r.audio);var d=W(r);if(!0===d&&void 0!=r&&null!=r)if(r.video&&"screen"!=r.video&&"window"!=r.video){var u=0,f=0,v=0;if("lowres"===r.video)f=240,v=240,u=320;else if("lowres-16:9"===r.video)f=180,v=180,u=320;else if("hires"===r.video||"hires-16:9"===r.video){if(f=720,v=720,u=1280,navigator.mozGetUserMedia)(g=parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1],10))<38&&(V.warn(r.video+" unsupported, falling back to stdres (old Firefox)"),f=480,v=480,u=640)}else"stdres"===r.video?(f=480,v=480,u=640):"stdres-16:9"===r.video?(f=360,v=360,u=640):(V.log("Default video setting ("+r.video+") is stdres 4:3"),f=480,v=480,u=640);if(V.log("Adding media constraint "+r.video),navigator.mozGetUserMedia){var g=parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1],10);d=g<38?{require:["height","width"],height:{max:v,min:f},width:{max:u,min:u}}:{height:{ideal:f},width:{ideal:u}}}else d={mandatory:{maxHeight:v,minHeight:f,maxWidth:u,minWidth:u},optional:[]};"object"===typeof r.video&&(d=r.video),V.debug(d)}else if("screen"===r.video||"window"===r.video){var p=function(a,i){o.consentDialog(!1),a?n.error({code:a.code,name:a.name,message:a.message}):T(e,t,r,n,i)},m=function(e,n,t){V.log("Adding media constraint (screen capture)"),V.debug(e),navigator.mediaDevices.getUserMedia(e).then((function(e){t?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(t){e.addTrack(t.getAudioTracks()[0]),n(null,e)})):n(null,e)})).catch((function(e){o.consentDialog(!1),n(e)}))};if(r.screenshareFrameRate||(r.screenshareFrameRate=3),"https:"!==window.location.protocol)return V.warn("Screen sharing only works on HTTPS, try the https:// version of this page"),o.consentDialog(!1),void n.error("Screen sharing only works on HTTPS, try the https:// version of this page");var h={};if("chrome"===B.a.browserDetails.browser){var y=B.a.browserDetails.version,w=33;if(window.navigator.userAgent.match("Linux")&&(w=35),y>=26&&y<=w)c={video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:r.screenshareFrameRate,maxFrameRate:r.screenshareFrameRate,chromeMediaSource:"screen"}},audio:q(r)},m(c,p);else{var j=window.setTimeout((function(){return(S=new Error("NavigatorUserMediaError")).name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)',o.consentDialog(!1),n.error(S)}),1e3);h[j]=[p,null],window.postMessage({type:"janusGetScreen",id:j},"*")}}else if(window.navigator.userAgent.match("Firefox")){if(!(parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1],10)>=33)){var S=new Error("NavigatorUserMediaError");return S.name="Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)",o.consentDialog(!1),void n.error(S)}c={video:{mozMediaSource:r.video,mediaSource:r.video},audio:q(r)},m(c,(function(e,n){if(p(e,n),!e)var t=n.currentTime,r=window.setInterval((function(){n||window.clearInterval(r),n.currentTime==t&&(window.clearInterval(r),n.onended&&n.onended()),t=n.currentTime}),500)}))}return void window.addEventListener("message",(function(e){if(e.origin==window.location.origin)if("janusGotScreen"==e.data.type&&h[e.data.id]){var t=h[e.data.id][0];if(delete h[e.data.id],""===e.data.sourceId){var a=new Error("NavigatorUserMediaError");a.name="You cancelled the request for permission, giving up...",o.consentDialog(!1),n.error(a)}else(c={audio:!0,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:r.screenshareFrameRate,maxFrameRate:r.screenshareFrameRate},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}}).video.mandatory.chromeMediaSourceId=e.data.sourceId,m(c,t,q(r))}else"janusGetScreenPending"==e.data.type&&window.clearTimeout(e.data.id)}))}null!==r&&void 0!==r&&"screen"===r.video||navigator.mediaDevices.enumerateDevices().then((function(a){var i=a.some((function(e){return"audioinput"===e.kind})),s=a.some((function(e){return"videoinput"===e.kind})),c=q(r),u=W(r),f=function(e){return V.debug("isAudioSendRequired:",e),void 0!==e&&null!==e&&(!1!==e.audio&&!1!==e.audioSend&&(void 0!==e.failIfNoAudio&&null!==e.failIfNoAudio&&!0===e.failIfNoAudio))}(r),v=function(e){return V.debug("isVideoSendRequired:",e),void 0!==e&&null!==e&&(!1!==e.video&&!1!==e.videoSend&&(void 0!==e.failIfNoVideo&&null!==e.failIfNoVideo&&!0===e.failIfNoVideo))}(r);if(c||u||f||v){var g=!!c&&i,p=!!u&&s;if(!g&&!p)return o.consentDialog(!1),n.error("No capture device found"),!1;if(!g&&f)return o.consentDialog(!1),n.error("Audio capture is required, but no capture device found"),!1;if(!p&&v)return o.consentDialog(!1),n.error("Video capture is required, but no capture device found"),!1}navigator.mediaDevices.getUserMedia({audio:!!i&&l,video:!!s&&d}).then((function(a){o.consentDialog(!1),T(e,t,r,n,a)})).catch((function(e){o.consentDialog(!1),n.error({code:e.code,name:e.name,message:e.message})}))})).catch((function(e){o.consentDialog(!1),n.error("enumerateDevices error",e)}))}else T(e,t,r,n)}function D(e,n){(n=n||{}).success="function"==typeof n.success?n.success:V.noop,n.error="function"==typeof n.error?n.error:J;var t=n.jsep,r=b[e];if(null===r||void 0===r||null===r.webrtcStuff||void 0===r.webrtcStuff)return V.warn("Invalid handle"),void n.error("Invalid handle");var o=r.webrtcStuff;if(void 0!==t&&null!==t){if(null===o.pc)return V.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),void n.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep");"edge"===B.a.browserDetails.browser&&(t.sdp+="a=end-of-candidates\r\n"),o.pc.setRemoteDescription(new RTCSessionDescription(t),(function(){V.log("Remote description accepted!"),n.success()}),n.error)}else n.error("Invalid JSEP")}function I(e,n,t){(t=t||{}).success="function"==typeof t.success?t.success:V.noop,t.error="function"==typeof t.error?t.error:V.noop;var r=b[e];if(null===r||void 0===r||null===r.webrtcStuff||void 0===r.webrtcStuff)return V.warn("Invalid handle"),void t.error("Invalid handle");var o=r.webrtcStuff;V.log("Creating offer (iceDone="+o.iceDone+")");var a=null;a="firefox"==B.a.browserDetails.browser||"edge"==B.a.browserDetails.browser?{offerToReceiveAudio:F(n),offerToReceiveVideo:H(n)}:{mandatory:{OfferToReceiveAudio:F(n),OfferToReceiveVideo:H(n)}},V.debug(a),o.pc.createOffer((function(e){if(V.debug(e),null!==o.mySdp&&void 0!==o.mySdp||(V.log("Setting local description"),o.mySdp=e.sdp,o.pc.setLocalDescription(e)),o.iceDone||o.trickle)if(o.sdpSent)V.log("Offer already sent, not sending it again");else{V.log("Offer ready"),V.debug(t),o.sdpSent=!0;var n={type:e.type,sdp:e.sdp};t.success(n)}else V.log("Waiting for all candidates...")}),t.error,a)}function A(e,n,t){(t=t||{}).success="function"==typeof t.success?t.success:V.noop,t.error="function"==typeof t.error?t.error:V.noop;var r=b[e];if(null===r||void 0===r||null===r.webrtcStuff||void 0===r.webrtcStuff)return V.warn("Invalid handle"),void t.error("Invalid handle");var o=r.webrtcStuff;V.log("Creating answer (iceDone="+o.iceDone+")");var a=null;a="firefox"==B.a.browserDetails.browser||"edge"==B.a.browserDetails.browser?{offerToReceiveAudio:F(n),offerToReceiveVideo:H(n)}:{mandatory:{OfferToReceiveAudio:F(n),OfferToReceiveVideo:H(n)}},V.debug(a),o.pc.createAnswer((function(e){if(V.debug(e),null!==o.mySdp&&void 0!==o.mySdp||(V.log("Setting local description"),o.mySdp=e.sdp,o.pc.setLocalDescription(e)),o.iceDone||o.trickle)if(o.sdpSent)V.log("Answer already sent, not sending it again");else{o.sdpSent=!0;var n={type:e.type,sdp:e.sdp};t.success(n)}else V.log("Waiting for all candidates...")}),t.error,a)}function E(e){var n=b[e];if(null===n||void 0===n||null===n.webrtcStuff||void 0===n.webrtcStuff)return V.warn("Invalid handle"),0;var t=n.webrtcStuff;return t.pc.getStats&&"chrome"==B.a.browserDetails.browser?null===t.remoteStream||void 0===t.remoteStream?(V.warn("Remote stream unavailable"),0):null===t.volume.timer||void 0===t.volume.timer?(V.log("Starting volume monitor"),t.volume.timer=setInterval((function(){t.pc.getStats((function(e){for(var n=e.result(),r=0;r<n.length;r++){var o=n[r];"ssrc"==o.type&&o.stat("audioOutputLevel")&&(t.volume.value=o.stat("audioOutputLevel"))}}))}),200),0):t.volume.value:(V.log("Getting the remote volume unsupported by browser"),0)}function M(e,n){var t=b[e];if(null===t||void 0===t||null===t.webrtcStuff||void 0===t.webrtcStuff)return V.warn("Invalid handle"),!0;var r=t.webrtcStuff;return null===r.pc||void 0===r.pc?(V.warn("Invalid PeerConnection"),!0):void 0===r.myStream||null===r.myStream?(V.warn("Invalid local MediaStream"),!0):n?null===r.myStream.getVideoTracks()||void 0===r.myStream.getVideoTracks()||0===r.myStream.getVideoTracks().length?(V.warn("No video track"),!0):!r.myStream.getVideoTracks()[0].enabled:null===r.myStream.getAudioTracks()||void 0===r.myStream.getAudioTracks()||0===r.myStream.getAudioTracks().length?(V.warn("No audio track"),!0):!r.myStream.getAudioTracks()[0].enabled}function L(e,n,t){var r=b[e];if(null===r||void 0===r||null===r.webrtcStuff||void 0===r.webrtcStuff)return V.warn("Invalid handle"),!1;var o=r.webrtcStuff;return null===o.pc||void 0===o.pc?(V.warn("Invalid PeerConnection"),!1):void 0===o.myStream||null===o.myStream?(V.warn("Invalid local MediaStream"),!1):n?null===o.myStream.getVideoTracks()||void 0===o.myStream.getVideoTracks()||0===o.myStream.getVideoTracks().length?(V.warn("No video track"),!1):(o.myStream.getVideoTracks()[0].enabled=!t,!0):null===o.myStream.getAudioTracks()||void 0===o.myStream.getAudioTracks()||0===o.myStream.getAudioTracks().length?(V.warn("No audio track"),!1):(o.myStream.getAudioTracks()[0].enabled=!t,!0)}function P(e){var n=b[e];if(null===n||void 0===n||null===n.webrtcStuff||void 0===n.webrtcStuff)return V.warn("Invalid handle"),"Invalid handle";var t=n.webrtcStuff;if(null===t.pc||void 0===t.pc)return"Invalid PeerConnection";if(t.pc.getStats&&"chrome"==B.a.browserDetails.browser)return null===t.remoteStream||void 0===t.remoteStream?(V.warn("Remote stream unavailable"),"Remote stream unavailable"):null===t.bitrate.timer||void 0===t.bitrate.timer?(V.log("Starting bitrate timer (Chrome)"),t.bitrate.timer=setInterval((function(){t.pc.getStats((function(e){for(var n=e.result(),r=0;r<n.length;r++){var o=n[r];if("ssrc"==o.type&&o.stat("googFrameHeightReceived"))if(t.bitrate.bsnow=o.stat("bytesReceived"),t.bitrate.tsnow=o.timestamp,null===t.bitrate.bsbefore||null===t.bitrate.tsbefore)t.bitrate.bsbefore=t.bitrate.bsnow,t.bitrate.tsbefore=t.bitrate.tsnow;else{var a=Math.round(8*(t.bitrate.bsnow-t.bitrate.bsbefore)/(t.bitrate.tsnow-t.bitrate.tsbefore));t.bitrate.value=a+" kbits/sec",t.bitrate.bsbefore=t.bitrate.bsnow,t.bitrate.tsbefore=t.bitrate.tsnow}}}))}),1e3),"0 kbits/sec"):t.bitrate.value;if(t.pc.getStats&&"firefox"==B.a.browserDetails.browser){if(null===t.remoteStream||void 0===t.remoteStream||null===t.remoteStream.streams[0]||void 0===t.remoteStream.streams[0])return V.warn("Remote stream unavailable"),"Remote stream unavailable";var r=t.remoteStream.streams[0].getVideoTracks();return null===r||void 0===r||r.length<1?(V.warn("No video track"),"No video track"):null===t.bitrate.timer||void 0===t.bitrate.timer?(V.log("Starting bitrate timer (Firefox)"),t.bitrate.timer=setInterval((function(){var e=function(e){if(null!==e&&void 0!==e&&null!=e.inbound_rtp_video_1&&null!=e.inbound_rtp_video_1)if(t.bitrate.bsnow=e.inbound_rtp_video_1.bytesReceived,t.bitrate.tsnow=e.inbound_rtp_video_1.timestamp,null===t.bitrate.bsbefore||null===t.bitrate.tsbefore)t.bitrate.bsbefore=t.bitrate.bsnow,t.bitrate.tsbefore=t.bitrate.tsnow;else{var n=Math.round(8*(t.bitrate.bsnow-t.bitrate.bsbefore)/(t.bitrate.tsnow-t.bitrate.tsbefore));t.bitrate.value=n+" kbits/sec",t.bitrate.bsbefore=t.bitrate.bsnow,t.bitrate.tsbefore=t.bitrate.tsnow}else t.bitrate.value="Missing inbound_rtp_video_1"};t.pc.getStats(r[0],(function(n){e(n)}),e)}),1e3),"0 kbits/sec"):t.bitrate.value}return V.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser"}function J(e){V.error("WebRTC error:",e)}function U(e,r){V.log("Cleaning WebRTC stuff");var o=b[e];if(null!==o&&void 0!==o){var a=o.webrtcStuff;if(null!==a&&void 0!==a){if(!0===r){var i={janus:"hangup",transaction:V.randomString(12)};null!==v&&void 0!==v&&(i.token=v),null!==g&&void 0!==g&&(i.apisecret=g),V.debug("Sending hangup request (handle="+e+"):"),V.debug(i),n?(i.session_id=m,i.handle_id=e,t.send(JSON.stringify(i))):V.ajax({type:"POST",url:s+"/"+m+"/"+e,withCredentials:u,cache:!1,contentType:"application/json",data:JSON.stringify(i),dataType:"json"})}a.remoteStream=null,a.volume.timer&&clearInterval(a.volume.timer),a.volume.value=null,a.bitrate.timer&&clearInterval(a.bitrate.timer),a.bitrate.timer=null,a.bitrate.bsnow=null,a.bitrate.bsbefore=null,a.bitrate.tsnow=null,a.bitrate.tsbefore=null,a.bitrate.value=null;try{a.streamExternal||null===a.myStream||void 0===a.myStream||(V.log("Stopping local stream"),a.myStream.stop())}catch(f){}try{if(!a.streamExternal&&null!==a.myStream&&void 0!==a.myStream){V.log("Stopping local stream tracks");var c=a.myStream.getTracks();for(var l in c){var d=c[l];V.log(d),null!==d&&void 0!==d&&d.stop()}}}catch(f){}a.streamExternal=!1,a.myStream=null;try{a.pc.close()}catch(f){}a.pc=null,a.mySdp=null,a.iceDone=!1,a.sdpSent=!1,a.dataChannel=null,a.dtmfSender=null}o.oncleanup()}}function q(e){return V.debug("isAudioSendEnabled:",e),void 0===e||null===e||!1!==e.audio&&(void 0===e.audioSend||null===e.audioSend||!0===e.audioSend)}function F(e){return V.debug("isAudioRecvEnabled:",e),void 0===e||null===e||!1!==e.audio&&(void 0===e.audioRecv||null===e.audioRecv||!0===e.audioRecv)}function W(e){return V.debug("isVideoSendEnabled:",e),void 0===e||null===e||!1!==e.video&&(void 0===e.videoSend||null===e.videoSend||!0===e.videoSend)}function H(e){return V.debug("isVideoRecvEnabled:",e),void 0===e||null===e||!1!==e.video&&(void 0===e.videoRecv||null===e.videoRecv||!0===e.videoRecv)}!function c(l){var d=V.randomString(12),f={janus:"create",transaction:d};null!==v&&void 0!==v&&(f.token=v);null!==g&&void 0!==g&&(f.apisecret=g);null===s&&Array.isArray(a)&&(0===(s=a[i]).indexOf("ws")?(n=!0,V.log("Server #"+(i+1)+": trying WebSockets to contact Janus ("+s+")")):(n=!1,V.log("Server #"+(i+1)+": trying REST API to contact Janus ("+s+")")));if(n){for(var b in t=new WebSocket(s,"janus-protocol"),r={error:function(){if(V.error("Error connecting to the Janus WebSockets server... "+s),Array.isArray(a))return++i==a.length?void l.error("Error connecting to any of the provided Janus servers: Is the gateway down?"):(s=null,void setTimeout((function(){c(l)}),200));l.error("Error connecting to the Janus WebSockets server: Is the gateway down?")},open:function(){w[d]=function(e){if(V.debug(e),"success"!==e.janus)return V.error("Ooops: "+e.error.code+" "+e.error.reason),void l.error(e.error.reason);o=setTimeout(O,3e4),p=!0,m=e.data.id,V.log("Created session: "+m),V.sessions[m]=h,l.success()},t.send(JSON.stringify(f))},message:function(e){try{S(JSON.parse(e.data))}catch(n){V.error("Error processing event:",n)}},close:function(){null!==s&&p&&(p=!1,e.error("Lost connection to the gateway (is it down?)"))}})t.addEventListener(b,r[b]);return}V.ajax({type:"POST",url:s,withCredentials:u,cache:!1,contentType:"application/json",data:JSON.stringify(f),success:function(e){if(V.debug(e),"success"!==e.janus)return V.error("Ooops: "+e.error.code+" "+e.error.reason),void l.error(e.error.reason);p=!0,m=e.data.id,V.log("Created session: "+m),V.sessions[m]=h,j(),l.success()},error:function(e,n,t){if(V.error(n+": "+t),Array.isArray(a))return++i==a.length?void l.error("Error connecting to any of the provided Janus servers: Is the gateway down?"):(s=null,void setTimeout((function(){c(l)}),200));""===t?l.error(n+": Is the gateway down?"):l.error(n+": "+t)},dataType:"json"})}(e),this.getServer=function(){return s},this.isConnected=function(){return p},this.getSessionId=function(){return m},this.destroy=function(a){!function(a){(a=a||{}).success="function"==typeof a.success?a.success:V.noop;var i=!0;void 0!==a.asyncRequest&&null!==a.asyncRequest&&(i=!0===a.asyncRequest);if(V.log("Destroying session "+m+" (async="+i+")"),!p)return V.warn("Is the gateway down? (connected=false)"),void a.success();if(void 0===m||null===m)return V.warn("No session to destroy"),a.success(),void e.destroyed();delete V.sessions[m];var c={janus:"destroy",transaction:V.randomString(12)};null!==v&&void 0!==v&&(c.token=v);null!==g&&void 0!==g&&(c.apisecret=g);if(n){c.session_id=m;var l=function(){for(var e in r)t.removeEventListener(e,r[e]);t.removeEventListener("message",d),t.removeEventListener("error",f),o&&clearTimeout(o)},d=function(n){var t=JSON.parse(n.data);t.session_id==c.session_id&&t.transaction==c.transaction&&(l(),a.success(),e.destroyed())},f=function(n){l(),a.error("Failed to destroy the gateway: Is the gateway down?"),e.destroyed()};return t.addEventListener("message",d),t.addEventListener("error",f),void t.send(JSON.stringify(c))}V.ajax({type:"POST",url:s+"/"+m,async:i,withCredentials:u,cache:!1,contentType:"application/json",data:JSON.stringify(c),success:function(n){V.log("Destroyed session:"),V.debug(n),m=null,p=!1,"success"!==n.janus&&V.error("Ooops: "+n.error.code+" "+n.error.reason),a.success(),e.destroyed()},error:function(n,t,r){V.error(t+": "+r),m=null,p=!1,a.success(),e.destroyed()},dataType:"json"})}(a)},this.attach=function(e){!function(e){if((e=e||{}).success="function"==typeof e.success?e.success:V.noop,e.error="function"==typeof e.error?e.error:V.noop,e.consentDialog="function"==typeof e.consentDialog?e.consentDialog:V.noop,e.iceState="function"==typeof e.iceState?e.iceState:V.noop,e.mediaState="function"==typeof e.mediaState?e.mediaState:V.noop,e.webrtcState="function"==typeof e.webrtcState?e.webrtcState:V.noop,e.slowLink="function"==typeof e.slowLink?e.slowLink:V.noop,e.onmessage="function"==typeof e.onmessage?e.onmessage:V.noop,e.onlocalstream="function"==typeof e.onlocalstream?e.onlocalstream:V.noop,e.onremotestream="function"==typeof e.onremotestream?e.onremotestream:V.noop,e.ondata="function"==typeof e.ondata?e.ondata:V.noop,e.ondataopen="function"==typeof e.ondataopen?e.ondataopen:V.noop,e.oncleanup="function"==typeof e.oncleanup?e.oncleanup:V.noop,e.ondetached="function"==typeof e.ondetached?e.ondetached:V.noop,!p)return V.warn("Is the gateway down? (connected=false)"),void e.error("Is the gateway down? (connected=false)");var r=e.plugin;if(void 0===r||null===r)return V.error("Invalid plugin"),void e.error("Invalid plugin");var o=e.opaqueId,a=V.randomString(12),i={janus:"attach",plugin:r,opaque_id:o,transaction:a};null!==v&&void 0!==v&&(i.token=v);null!==g&&void 0!==g&&(i.apisecret=g);"chrome"!=B.a.browserDetails.browser&&"firefox"!=B.a.browserDetails.browser||(i["force-bundle"]=!0,i["force-rtcp-mux"]=!0);if(n)return w[a]=function(n){if(V.debug(n),"success"!==n.janus)return V.error("Ooops: "+n.error.code+" "+n.error.reason),void e.error("Ooops: "+n.error.code+" "+n.error.reason);var t=n.data.id;V.log("Created handle: "+t);var o={session:h,plugin:r,id:t,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,pc:null,dataChannel:null,dtmfSender:null,trickle:!0,iceDone:!1,sdpSent:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return t},getPlugin:function(){return r},getVolume:function(){return E(t)},isAudioMuted:function(){return M(t,!1)},muteAudio:function(){return L(t,!1,!0)},unmuteAudio:function(){return L(t,!1,!1)},isVideoMuted:function(){return M(t,!0)},muteVideo:function(){return L(t,!0,!0)},unmuteVideo:function(){return L(t,!0,!1)},getBitrate:function(){return P(t)},send:function(e){_(t,e)},data:function(e){C(t,e)},dtmf:function(e){k(t,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){N(t,e)},createAnswer:function(e){N(t,e)},handleRemoteJsep:function(e){D(t,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){U(t,!0===e)},detach:function(e){R(t,e)}};b[t]=o,e.success(o)},i.session_id=m,console.log("||||||",i),void t.send(JSON.stringify(i));V.ajax({type:"POST",url:s+"/"+m,withCredentials:u,cache:!1,contentType:"application/json",data:JSON.stringify(i),success:function(n){if(V.debug(n),"success"!==n.janus)return V.error("Ooops: "+n.error.code+" "+n.error.reason),void e.error("Ooops: "+n.error.code+" "+n.error.reason);var t=n.data.id;V.log("Created handle: "+t);var o={session:h,plugin:r,id:t,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,pc:null,dataChannel:null,dtmfSender:null,trickle:!0,iceDone:!1,sdpSent:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return t},getPlugin:function(){return r},getVolume:function(){return E(t)},isAudioMuted:function(){return M(t,!1)},muteAudio:function(){return L(t,!1,!0)},unmuteAudio:function(){return L(t,!1,!1)},isVideoMuted:function(){return M(t,!0)},muteVideo:function(){return L(t,!0,!0)},unmuteVideo:function(){return L(t,!0,!1)},getBitrate:function(){return P(t)},send:function(e){_(t,e)},data:function(e){C(t,e)},dtmf:function(e){k(t,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){N(t,e)},createAnswer:function(e){N(t,e)},handleRemoteJsep:function(e){D(t,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){U(t,!0===e)},detach:function(e){R(t,e)}};b[t]=o,e.success(o)},error:function(e,n,t){V.error(n+": "+t)},dataType:"json"})}(e)}}V.sessions={},V.extensionId="hapfgfdkleiggjjpfpenajgdnfckjpaj",V.isExtensionEnabled=function(){if(window.navigator.userAgent.match("Chrome")){var e=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),n=33;return window.navigator.userAgent.match("Linux")&&(n=35),e>=26&&e<=n||null!==document.getElementById("janus-extension-installed")}return!0},V.noop=function(){},V.init=function(e){if((e=e||{}).callback="function"==typeof e.callback?e.callback:V.noop,!0===V.initDone)e.callback();else{if("undefined"!=typeof console&&"undefined"!=typeof console.log||(console={log:function(){}}),V.trace=V.noop,V.debug=V.noop,V.vdebug=V.noop,V.log=V.noop,V.warn=V.noop,V.error=V.noop,!0===e.debug||"all"===e.debug)V.trace=console.trace.bind(console),V.debug=console.debug.bind(console),V.vdebug=console.debug.bind(console),V.log=console.log.bind(console),V.warn=console.warn.bind(console),V.error=console.error.bind(console);else if(Array.isArray(e.debug))for(var n in e.debug){var t=e.debug[n];switch(t){case"trace":V.trace=console.trace.bind(console);break;case"debug":V.debug=console.debug.bind(console);break;case"vdebug":V.vdebug=console.debug.bind(console);break;case"log":V.log=console.log.bind(console);break;case"warn":V.warn=console.warn.bind(console);break;case"error":V.error=console.error.bind(console);break;default:console.error("Unknown debugging option '"+t+"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')")}}V.log("Initializing library"),V.listDevices=function(e,n){e="function"==typeof e?e:V.noop,null==n&&(n={audio:!0,video:!0}),navigator.mediaDevices?navigator.mediaDevices.getUserMedia(n).then((function(n){navigator.mediaDevices.enumerateDevices().then((function(t){V.debug(t),e(t);try{n.stop()}catch(i){}try{var r=n.getTracks();for(var o in r){var a=r[o];null!==a&&void 0!==a&&a.stop()}}catch(i){}}))})).catch((function(n){V.error(n),e([])})):(V.warn("navigator.mediaDevices unavailable"),e([]))},V.attachMediaStream=function(e,n){"chrome"===B.a.browserDetails.browser?B.a.browserDetails.version>=43?e.srcObject=n:"undefined"!==typeof e.src?e.src=URL.createObjectURL(n):V.error("Error attaching stream to element"):e.srcObject=n},V.reattachMediaStream=function(e,n){"chrome"===B.a.browserDetails.browser?B.a.browserDetails.version>=43?e.srcObject=n.srcObject:"undefined"!==typeof e.src&&(e.src=n.src):"safari"===B.a.browserDetails.browser||window.navigator.userAgent.match(/iPad/i)||window.navigator.userAgent.match(/iPhone/i)?e.src=n.src:e.srcObject=n.srcObject},V.ajax=function(e){if(null!==e&&void 0!==e){if(e.success="function"==typeof e.success?e.success:V.noop,e.error="function"==typeof e.error?e.error:V.noop,null===e.url||void 0===e.url)return V.error("Missing url",e.url),void e.error(null,-1,"Missing url");e.async=null===e.async||void 0===e.async||!0===e.async,V.log(e);var n=new XMLHttpRequest;n.open(e.type,e.url,e.async),null!==e.contentType&&void 0!==e.contentType&&n.setRequestHeader("Content-type",e.contentType),null!==e.withCredentials&&void 0!==e.withCredentials&&(n.withCredentials=e.withCredentials),e.async&&(n.onreadystatechange=function(){if(4==n.readyState)if(200===n.status)try{e.success(JSON.parse(n.responseText))}catch(t){e.error(n,n.status,"Could not parse response, error: "+t+", text: "+n.responseText)}else e.error(n,0!==n.status?n.status:"error","")});try{if(n.send(e.data),!e.async){if(200!==n.status)return void e.error(n,0!==n.status?n.status:"error","");try{e.success(JSON.parse(n.responseText))}catch(t){e.error(n,n.status,"Could not parse response, error: "+t+", text: "+n.responseText)}}}catch(t){e.error(n,"error","")}}};var r=window.onbeforeunload;window.onbeforeunload=function(){for(var e in V.log("Closing window"),V.sessions)null!==V.sessions[e]&&void 0!==V.sessions[e]&&V.sessions[e].destroyOnUnload&&(V.log("Destroying session "+e),V.sessions[e].destroy({asyncRequest:!1}));r&&"function"==typeof r&&r()},V.initDone=!0,e.callback()}},V.isWebrtcSupported=function(){return void 0!==window.RTCPeerConnection&&null!==window.RTCPeerConnection&&void 0!==navigator.getUserMedia&&null!==navigator.getUserMedia},V.randomString=function(e){for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="",r=0;r<e;r++){var o=Math.floor(Math.random()*n.length);t+=n.substring(o,o+1)}return t};var q=V;function F(e,n){n=n||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var t="",r=0;r<e;r++){var o=Math.floor(Math.random()*n.length);t+=n.substring(o,o+1)}return t}function W(e,n,t,r){var o={textroom:"message",transaction:F(12),room:n,text:t,ack:!1};e.data({text:JSON.stringify(o),error:function(e){},success:function(){var e=JSON.parse(o.text);if(console.log("==== sendData ===="),console.log(o),"sent"==e.event){console.log("*** sendData"),console.log(o);var n={room_id:o.room,partner_user_id:R,from:T,time:JSON.stringify(L()().valueOf()),text:o.text};r(function(e){return function(){var n=Object(v.a)(f.a.mark((function n(t,r){var o;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t({type:b}),console.log("***** action: newMessageChatWidget ****"),n.prev=2,console.log("====== action: newMessage RAW ====="),console.log(e),n.next=7,A(e);case 7:(o=n.sent).status?(console.log("====* newMessageChatWidget *===="),console.log(o),t({type:h,payload:{message:o.data.data}})):t({type:y,error:"error"}),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(2),t({type:y,error:n.t0});case 14:case"end":return n.stop()}}),n,null,[[2,11]])})));return function(e,t){return n.apply(this,arguments)}}()}(n))}else e.event}})}var H=t(6),G=t(7),z=t(104),Y=t(0);var K=function(e){var n=e.handleCancelAddMsgReply,t=e.messReplyContent;return Object(Y.jsxs)("div",{className:"add-msg__reply",children:[Object(Y.jsxs)("div",{className:"add-msg__container",children:[Object(Y.jsxs)("div",{className:"add-msg__reply__title",children:["\u0110ang tr\u1ea3 l\u1eddi ",Object(Y.jsx)("strong",{children:" Nh\xe2n vi\xean CSKH "})]}),Object(Y.jsxs)("p",{className:"add-msg__reply__content",children:[" ",t," "]})]}),Object(Y.jsx)("div",{className:"add-msg__cancel",onClick:n,children:Object(Y.jsx)(G.a,{icon:H.i})})]})};var Q=function(e){var n=e.addMsgReplyVisible,t=e.handleCancelAddMsgReply,o=e.messReplyContent,a=e.chatroomHandler,i=Object(s.b)(),c=Object(r.useState)(""),l=Object(d.a)(c,2),u=l[0],f=l[1],v=Object(s.c)((function(e){return e.janus})).isConnected,g=Object(s.c)((function(e){return e.chat})),p=g.room;return g.listCount,g.list,Object(Y.jsxs)("div",{className:"add-msg",children:[n?Object(Y.jsx)(K,{handleCancelAddMsgReply:t,messReplyContent:o}):"",Object(Y.jsxs)("div",{className:"add-msg__wrap",children:[Object(Y.jsxs)("div",{className:"add-msg__camera",children:[Object(Y.jsx)("input",{type:"file",title:"",accept:"image/*"}),Object(Y.jsx)(G.a,{icon:H.a})]}),Object(Y.jsx)("input",{className:"add-msg__message",type:"text",value:u,onChange:function(e){return f(e.target.value)},onKeyUp:function(e){13===e.keyCode&&(e.preventDefault(),document.querySelector(".add-msg__send").click())}}),Object(Y.jsx)("div",{className:"add-msg__send",onClick:function(){if(u&&v){var e=JSON.stringify({id:Object(z.a)(),text:u,room:p,time:L()().valueOf(),event:"sent"});W(a,p,e,i),f("")}},children:Object(Y.jsx)(G.a,{icon:H.e})})]})]})};var X=function(e){return Object(Y.jsxs)("div",{className:"chat-tab__title__search-bar",children:[Object(Y.jsx)("div",{className:"chat-tab__title__search-bar__wrap-input",children:Object(Y.jsx)("input",{type:"search",placeholder:"Search"})}),Object(Y.jsx)("p",{className:"chat-tab__title__search-bar__result",children:' 1 / 2 k\u1ebft qu\u1ea3 cho "khach hang" '})]})};var Z=function(e){var n=e.handleClickPhoneBtn,t=e.handleClickSeachBtn,r=e.handleClickMinimizedIcon,o=e.searchBarVisible;return Object(Y.jsxs)("div",{className:"chat-tab__title",children:[Object(Y.jsxs)("div",{className:"chat-tab__title__group",children:[Object(Y.jsx)("h2",{children:" Chat v\u1edbi nh\xe2n vi\xean CSKH "}),Object(Y.jsxs)("ul",{className:"chat-tab__actions",children:[Object(Y.jsx)("li",{className:"items",id:"phoneBtn",onClick:n,children:Object(Y.jsx)(G.a,{icon:H.f})}),Object(Y.jsx)("li",{className:"items",onClick:t,children:Object(Y.jsx)(G.a,{icon:H.h})}),Object(Y.jsx)("li",{className:"items",onClick:r,children:Object(Y.jsx)(G.a,{icon:H.d})})]})]}),o?Object(Y.jsx)(X,{}):""]})},$=t(20),ee=t.n($);var ne=function(e){var n=e.handleClickReplyBtn,t=e.messContent,r=e.time,o=e.username;return Object(Y.jsxs)("li",{className:"reply-post",children:[Object(Y.jsxs)("div",{className:"reply-post__time",children:[" ",L()(r).format("HH:ss DD-MM-YYYY")," "]}),Object(Y.jsxs)("div",{className:"reply-group",children:[Object(Y.jsx)("div",{className:"reply-group__actions",children:Object(Y.jsx)("div",{className:"post__controls__icon-btn",onClick:function(){return n(t)},children:Object(Y.jsx)(G.a,{icon:H.g})})}),Object(Y.jsx)("div",{className:"reply-group__content",children:-1!==t.indexOf("[img]")&&-1!==t.indexOf("[/img]")?Object(Y.jsx)(Y.Fragment,{children:ee.a.toReact(t)}):Object(Y.jsx)("p",{children:t})}),Object(Y.jsx)("div",{className:"reply-group__avatar",children:Object(Y.jsx)("div",{className:"reply-group__avatar__icon",children:Object(Y.jsx)("img",{src:"https://avatars.dicebear.com/api/human/".concat(o,".svg"),alt:""})})})]})]})};t.p,t(100);var te=function(e){var n=e.handleClickReplyBtn,t=e.messContent,r=e.time,o=e.username;return Object(Y.jsxs)("li",{className:"sent-post",children:[Object(Y.jsxs)("div",{className:"sent-post__time",children:[" ",L()(r).format("HH:ss DD-MM-YYYY")," "]}),Object(Y.jsxs)("div",{className:"sent-group",children:[Object(Y.jsx)("div",{className:"sent-group__avatar",children:Object(Y.jsx)("div",{className:"sent-group__avatar__icon",children:Object(Y.jsx)("img",{src:"https://avatars.dicebear.com/api/human/".concat(o,".svg"),alt:""})})}),Object(Y.jsx)("div",{className:"sent-group__content",children:-1!==t.indexOf("[img]")&&-1!==t.indexOf("[/img]")?Object(Y.jsx)(Y.Fragment,{children:ee.a.toReact(t)}):Object(Y.jsx)("p",{children:t})}),Object(Y.jsx)("div",{className:"sent-group__actions",children:Object(Y.jsx)("div",{className:"post__controls__icon-btn",onClick:function(){return n(t)},children:Object(Y.jsx)(G.a,{icon:H.g})})})]})]})};var re=function(e){var n=e.handleClickReplyBtn,t=e.list,o=Object(s.c)((function(e){return e.chat})).listCount,a=function(e){var n=Object(r.useRef)(null),t=Object(r.useState)(!1),o=Object(d.a)(t,2),a=o[0],i=o[1],s=Object(r.useState)(0),c=Object(d.a)(s,2),l=c[0],u=c[1],f=function(e,n){e.forEach((function(e){e.intersectionRatio>l?(console.log("inter"),i(!0)):(console.log("des"),i(!1)),u(e.intersectionRatio)}))};return Object(r.useEffect)((function(){var t=new IntersectionObserver(f,e);return n.current&&t.observe(n.current),function(){n.current&&t.unobserve(n.current)}}),[n,e]),[n,a]}({root:null,rootMargin:"0px",threshold:1}),i=Object(d.a)(a,2),c=(i[0],i[1]);return Object(r.useEffect)((function(){c?console.log("inter true"):console.log("inter false")}),[c]),Object(r.useEffect)((function(){var e=document.querySelector(".chat-tab__posts");e&&(e.scrollTop=e.scrollHeight)}),[t]),Object(Y.jsx)("div",{className:"chat-tab__posts",children:Object(Y.jsx)("ul",{children:o>0&&t.map((function(e){var t;return e.partner_id==(null===(t=e.room_id)||void 0===t?void 0:t.split("-")[0])?Object(Y.jsx)(ne,{time:e.time,messContent:e.text,username:e.partner_id+"-"+e.partner_user_id+"-"+e.from,handleClickReplyBtn:n},e.id):Object(Y.jsx)(te,{time:e.time,messContent:e.text,username:e.partner_id+"-"+e.partner_user_id+"-"+e.from,handleClickReplyBtn:n},e.id)}))})})};var oe=function(e){var n=e.handleClickCancelBtn,t=e.handleClickAcceptBtn,o=Object(r.useState)(null),a=Object(d.a)(o,2),i=a[0],s=a[1],c=Object(r.useState)(!0),l=Object(d.a)(c,2),u=l[0],f=l[1],v={border:"1px solid",borderRadius:"50%",width:"50px",height:"50px"};return Object(r.useEffect)((function(){s(null)}),[]),Object(Y.jsx)("div",{className:"call-alert",children:Object(Y.jsxs)("div",{className:"call-alert__wrap",children:[Object(Y.jsxs)("div",{className:"call-alert__user",children:[Object(Y.jsx)("div",{className:"call-alert__user__avatar",children:Object(Y.jsx)("img",{src:"https://avatars.dicebear.com/api/human/".concat(N,".svg"),alt:""})}),Object(Y.jsx)("div",{className:"call-alert__user__name",children:"Nguy\u1ec5n Trung \u0110\u1ee9c"})]}),Object(Y.jsxs)("div",{className:"call-alert__status",children:[i?Object(Y.jsx)("p",{className:"call-alert__time",children:i}):Object(Y.jsx)(Y.Fragment,{children:"\u0110ang g\u1ecdi..."}),Object(Y.jsxs)("div",{children:[Object(Y.jsx)("audio",{id:"localAudio",controls:!0,autoPlay:!0,playsInline:!0,muted:!0}),Object(Y.jsx)("audio",{id:"remoteAudio",controls:!0,autoPlay:!0,playsInline:!0,onTimeUpdate:function(e){var n=Math.floor(e.timeStamp),t=L()(n).format("mm:ss");s(t)}})]})]}),Object(Y.jsx)("div",{className:"call-alert__controls",children:i?Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsx)("button",{className:"call-alert__controls__item",id:"cancelBtn",onClick:n,style:v,children:Object(Y.jsx)("div",{className:"call-alert__controls__item__icon__cancel",children:Object(Y.jsx)(G.a,{icon:H.f})})}),Object(Y.jsx)("button",{className:"call-alert__controls__item",id:"microphoneBtn",onClick:function(){f(!u)},style:v,children:Object(Y.jsx)("div",{className:"call-alert__controls__item__icon__microphone",children:Object(Y.jsx)(G.a,{icon:u?H.b:H.c})})})]}):Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsxs)("button",{className:"call-alert__controls__item",id:"cancelBtn",onClick:n,children:[Object(Y.jsx)("div",{className:"call-alert__controls__item__icon__cancel",children:Object(Y.jsx)(G.a,{icon:H.f})}),"Cancel"]}),Object(Y.jsxs)("button",{className:"call-alert__controls__item",id:"acceptBtn",onClick:t,children:[Object(Y.jsx)("div",{className:"call-alert__controls__item__icon__accept",children:Object(Y.jsx)(G.a,{icon:H.f})}),"Accept"]})]})})]})})};var ae=function(e){var n=e.handleClickPhoneBtn,t=e.handleClickSeachBtn,r=e.handleClickMinimizedIcon,o=e.searchBarVisible,a=e.handleClickReplyBtn,i=e.addMsgReplyVisible,c=e.handleCancelAddMsgReply,l=e.messReplyContent,d=e.position,u=e.chatroomHandler,f=e.callModalVisible,v=e.handleClickCancelBtn,g=e.handleClickAcceptBtn,p=Object(s.c)((function(e){return e.chat})),m=(p.listCount,p.list);return Object(Y.jsxs)("div",{className:"chat-tab",style:"right"===d?{marginRight:"3.4375rem",right:0}:{marginLeft:"3.4375rem"},children:[Object(Y.jsx)(Z,{handleClickPhoneBtn:n,handleClickSeachBtn:t,handleClickMinimizedIcon:r,searchBarVisible:o}),f?Object(Y.jsx)(oe,{handleClickCancelBtn:v,handleClickAcceptBtn:g}):Object(Y.jsx)(re,{handleClickReplyBtn:a,list:m}),Object(Y.jsx)(Q,{messReplyContent:l,addMsgReplyVisible:i,handleCancelAddMsgReply:c,chatroomHandler:u})]})};var ie=function(e){var n=e.position,t=e.opaqueId,o=e.username,a=e.server,i=e.isPublisher,c=e.display,l=Object(s.b)(),u=Object(r.useState)(!1),b=Object(d.a)(u,2),y=b[0],O=b[1],_=Object(r.useState)(!1),x=Object(d.a)(_,2),C=x[0],k=x[1],I=Object(r.useState)(!1),A=Object(d.a)(I,2),M=A[0],P=A[1],U=Object(r.useState)(!1),B=Object(d.a)(U,2),V=B[0],W=B[1],H=Object(r.useState)(null),G=Object(d.a)(H,2),z=G[0],K=G[1],Q=Object(r.useState)(null),X=Object(d.a)(Q,2),Z=X[0],$=X[1],ee=Object(r.useState)(""),ne=Object(d.a)(ee,2),te=ne[0],re=ne[1],oe=Object(r.useState)(null),ie=Object(d.a)(oe,2),se=ie[0],ce=ie[1],le=Object(r.useState)(null),de=Object(d.a)(le,2),ue=(de[0],de[1]),fe=Object(r.useState)(null),ve=Object(d.a)(fe,2),ge=ve[0],pe=ve[1],me=Object(s.c)((function(e){return e.chat})).room;return Object(r.useEffect)((function(){l(function(e){return function(){var n=Object(v.a)(f.a.mark((function n(t,r){var o;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t({type:g}),console.log("***** action: requireRoomAction ****"),n.prev=2,console.log("==== dataBody ===="),console.log(e),n.next=7,r=e,D({method:"POST",url:"".concat("/api/v1/room","/requireRoom"),data:r});case 7:o=n.sent,console.log(o),o.status?t({type:p,payload:{room:o.data.data.room}}):t({type:m,error:"error"}),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(2),t({type:m,error:n.t0});case 15:case"end":return n.stop()}var r}),n,null,[[2,12]])})));return function(e,t){return n.apply(this,arguments)}}()}({from_user_id:R,from_name:T,to_partner_id:1}))}),[]),Object(r.useEffect)((function(){me&&q.init({debug:"all",callback:function(){if(q.isWebrtcSupported())var e=new q({server:a,success:function(){console.log("Janus loaded"),K(e),l(function(){var e=Object(v.a)(f.a.mark((function e(n,t){var r,o,a,i,s,c,l,d;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("===**** getState"),r=t(),n({type:w}),e.prev=3,o={room:r.chat.room},console.log("params"),console.log(o),e.next=9,E(o);case 9:(a=e.sent).status&&(i=a.data,s=i.data,c=s.count,l=s.list,d=i.status,console.log("0000* chatScrollLoadAction"),console.log(a.data),n({type:j,payload:{listCount:c,list:l,scrollLoadStatus:d}})),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),n({type:S,payload:{error:e.t0}});case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(n,t){return e.apply(this,arguments)}}()),l({type:J,payload:{janusInstance:e}})},error:function(e){q.error(e),K(null)},destroyed:function(){K(null)}});else console.log("No WebRTC support... ")}})}),[me]),Object(r.useEffect)((function(){!function(e,n,t,r,o,a,i){var s;e&&e.attach({plugin:"janus.plugin.textroom",opaqueId:n,success:function(e){console.log("++++++++++++++++++++++++++++++++++++++++++++++"),console.log(e),s=e;var n={request:"setup"};console.log("###############"+JSON.stringify(n)),s.send({message:n})},error:function(e){console.error("  -- Error attaching plugin...",e)},webrtcState:function(e){q.log("Janus says our WebRTC PeerConnection is "+(e?"up":"down")+" now")},onmessage:function(e,n){q.debug(" ::: Got a message :::"),q.debug(e),void 0!==e.error&&e.error,void 0!==n&&null!==n&&s.createAnswer({jsep:n,media:{audio:!1,video:!1,data:!0},success:function(e){q.debug("Got SDP!"),q.debug(e),s.send({message:{request:"ack"},jsep:e})},error:function(e){q.error("WebRTC error:",e)}})},ondataopen:function(e){if(q.log("The DataChannel is available!"),t)s.send({message:{request:"create"},success:function(e){console.log("==== ondataopen ===="),console.log(e);var n=e.room;i(s,"created",n);var t={textroom:"join",transaction:F(12),room:n,username:o,display:a};s.data({text:JSON.stringify(t),success:function(e){console.log("Publisher joined"),i(s,"joined")}})}});else{var n={textroom:"join",transaction:F(12),room:r,username:o,display:a};s.data({text:JSON.stringify(n),success:function(e){console.log("Subscriber joined"),i(s,"joined")}})}},ondata:function(e){q.debug("We got data from the DataChannel! "),console.log("=================="),console.log(e);var n=JSON.parse(e);if("message"===n.textroom){var t={room:n.room,from:n.from,data:JSON.parse(n.text).text,date:L()(n.date).valueOf()};i(s,"ondata",t)}},oncleanup:function(){q.log(" ::: Got a cleanup notification :::")}})}(z,t,i,me,o,c,(function(e,n,t){console.log("===== DATA RETURN ====="),console.log(t),console.log(n),"created"===n?console.log("==== created ===="):"joined"===n?(console.log("==== joined ===="),$(e)):"ondata"===n&&(console.log("==== ondata ===="),console.log(t),t.from!=o&&l({type:h,payload:{message:{room_id:t.room,from:t.from,text:t.data,time:t.date,partner_id:t.room.split("-")[1],partner_user_id:t.room.split("-")[2]}}}))})),console.log("==== publishVideoCall ===="),function(e,n,t,r){var o;e&&e.attach({plugin:"janus.plugin.videocall",opaqueId:n,success:function(e){o=e,console.log("videocall success");var n={request:"register",username:t};o.send({message:n})},error:function(e){console.log("  -- Error attaching plugin...",e)},consentDialog:function(e){},mediaState:function(e,n){},onmessage:function(e,n){console.log(" ::: Got a message :::",e);var t=e.result;if(t)if(t.list){var a=t.list;for(var i in q.debug("Got a list of registered peers:",a),a)q.debug("  >> ["+a[i]+"]")}else t.event&&r(o,t,n)},onlocalstream:function(e){q.attachMediaStream(document.querySelector("#localAudio"),e),o.send({message:{request:"set",audio:!0}})},onremotestream:function(e){q.attachMediaStream(document.querySelector("#remoteAudio"),e),o.send({message:{request:"set",audio:!0}})}})}(z,t,o,(function(e,n,t){console.log("==== DATA VIDEO CALL RETURN ===="),console.log(n),pe(t);var r=n.event;"registered"===r?(e.send({message:{request:"list"}}),ue("registered"),ce(e)):"calling"===r?ue("calling"):"incomingcall"===r?(P(!0),ue("incomingcall")):"accepted"===r?(ue("accepted"),t&&e.handleRemoteJsep({jsep:t})):"update"===r||"hangup"===r&&P(!1)}))}),[z]),Object(Y.jsxs)("div",{className:"chat-widget",style:{right:"right"===n?"0":""},children:[Object(Y.jsx)("div",{className:"chat-widget__icon-wrap",children:Object(Y.jsx)("div",{className:"chat-widget__icon",onClick:function(){O(!y)}})}),y?Object(Y.jsx)(ae,{handleClickPhoneBtn:function(){!function(e,n){n.createOffer({media:{data:!0,video:!1,audio:!0},simulcast:!0,success:function(t){var r={request:"call",username:e};n.send({message:r,jsep:t})},error:function(e){}})}(N,se),P(!0)},handleClickSeachBtn:function(){k(!C)},handleClickMinimizedIcon:function(){O(!1)},handleClickReplyBtn:function(e){re(e),W(!0)},handleCancelAddMsgReply:function(){W(!1)},handleClickCancelBtn:function(){console.log("handleClickCancelBtn"),function(e){console.log("88888 === doHangup"),e.send({message:{request:"hangup"}}),e.hangup()}(se),P(!1)},handleClickAcceptBtn:function(){console.log("handleClickAcceptBtn"),function(e,n){console.log("88888 === doAccept"),console.log(e),console.log(n),e.createAnswer({jsep:n,media:{videoSend:!1,audioSend:!0},simulcast:!1,success:function(n){console.log("doaccept"),console.log(n),e.send({message:{request:"accept"},jsep:n})},error:function(e){console.log("error")}})}(se,ge)},searchBarVisible:C,addMsgReplyVisible:V,messReplyContent:te,position:n,chatroomHandler:Z,callModalVisible:M}):""]})};var se=function(e){return Object(Y.jsx)(Y.Fragment,{children:Object(Y.jsx)(ie,{position:"left",opaqueId:"test4",username:"2-200-Nguy\u1ec5n Trung \u0110\u1ee9c",server:"wss://chat.hasaki.vn:8989",isPublisher:!1,display:T})})};t(102),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ce={room:"",listCount:0,list:[],scrollLoadStatus:{}};var le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case g:return Object(O.a)({},e);case p:return Object(O.a)(Object(O.a)({},e),{},{room:n.payload.room});case m:case b:return Object(O.a)({},e);case h:var t=e.list;return t.push(n.payload.message),Object(O.a)(Object(O.a)({},e),{},{list:t});case y:case w:return Object(O.a)({},e);case j:return Object(O.a)(Object(O.a)({},e),{},{listCount:n.payload.listCount,list:n.payload.list.reverse(),scrollLoadStatus:n.payload.scrollLoadStatus});case S:default:return Object(O.a)({},e)}},de={isConnected:!1,janusInstance:null};var ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case P:return Object(O.a)({},e);case J:return Object(O.a)(Object(O.a)({},e),{},{isConnected:!0,janusInstance:n.payload.janusInstance});case U:default:return Object(O.a)({},e)}},fe=Object(c.c)({chat:le,janus:ue}),ve=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||c.d,ge=Object(c.e)(fe,ve(Object(c.a)(l.a)));i.a.render(Object(Y.jsxs)(o.a.StrictMode,{children:[Object(Y.jsx)(s.a,{store:ge,children:Object(Y.jsx)(se,{})})," "]}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[103,1,2]]]);
//# sourceMappingURL=main.51fe7710.chunk.js.map